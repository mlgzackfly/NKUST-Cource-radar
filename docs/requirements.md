# 課程評價網站｜需求規格（Draft）

> 本文件用來記錄與釐清需求；每次討論後更新。  
> Workspace: `nkust/`  
> Last updated: 2025-12-14

## 1. 目標與範圍

### 1.1 產品目標（你可直接改寫）
- **幫助學生選課**：用可搜尋、可比較的評價與經驗分享降低踩雷。
- **回饋授課品質**：提供教師/系所可參考的匿名趨勢與建議（若學校政策允許）。
- **建立可信度**：降低灌水、洗評價、惡意攻擊，讓內容「可用且可信」。

### 1.2 非目標（先不做/不在範圍）
- **不做課表/排課工具**：本站聚焦在「查課 + 評價」。
- **不做校外使用者**：校外人士不可撰寫（瀏覽規則見 2.1、3.1）。

## 2. 使用者與權限（Roles）

### 2.1 角色（已確認）
- **訪客（未登入）**：可瀏覽課程與「評分摘要」，**不可查閱文字評論內容**（見 3.1）
- **一般使用者（已登入）**：NKUST 學生為主；**校友可撰寫**；可發表評價、留言、按「有幫助」、檢舉
- **管理員**：處理檢舉、隱藏/下架內容、封鎖使用者、要求修改

### 2.2 身分驗證（已確認）
- **一定要本校身份**：以 **`nkust.edu.tw` 學校信箱驗證** 作為登入/註冊門檻
- **校友撰寫規則（已確認）**：若沒有/無法使用 `nkust.edu.tw` 信箱，**不允許撰寫**（無替代驗證方案）

## 3. 核心使用流程（User Flows）

### 3.1 找課程 → 看評價 → 做決策
- 入口：搜尋課名/老師/系所/代碼 → 篩選（學期、必選修、通識、校區…）→ 課程頁
- 課程頁（未登入）：課程資訊 + **評價摘要（平均分/分佈）**
- 課程頁（已登入）：課程資訊 + 評價摘要 + **評價列表（含文字評論，可排序/篩選）**

### 3.2 發表評價
- 選課程 → 填寫評分維度 + 文字心得 → 送出
- 規則：**一人一課一則**
- **允許編輯**：可修改評價內容，但必須保留**舊版本（編輯紀錄）**

### 3.3 檢舉與審核
- 使用者檢舉（原因類型）→ 系統標記 → **管理員**處理（隱藏/下架/封鎖使用者/要求修改）

## 4. 功能清單（以 MVP 優先）

### 4.1 MVP（第一版必做）
- **課程資料庫**：課程列表、課程頁
- **搜尋與篩選**：課名/教師/系所/關鍵字
- **評價**：新增/查看（含「未登入只看評分摘要」的權限規則）
- **登入/驗證**：`nkust.edu.tw` 信箱驗證後才能看/寫文字內容
- **一人一課一則**：防重複評價（後續可討論是否允許編輯）
- **留言**：**掛在評價（review）** 的留言串
- **有幫助（按讚）**：可對評價點「有幫助」
- **檢舉**：評價可被檢舉，管理端可處理
- **管理後台（最小）**：查看檢舉清單、隱藏/下架、封鎖使用者、要求修改

### 4.2 非 MVP（第二階段）
- **收藏/追蹤**：收藏課程、追蹤老師
- **進階排序**：最有幫助/最新/最高分/最低分/最多回覆
- **互動擴充**：留言的回覆/提及、反應表情等
- **統計**：趨勢圖、不同學期對比
- **教師/系所視角儀表板**：彙整回饋（需合規）

## 5. 評分設計（Rubric）

### 5.1 評分維度（已確認）
- **涼度**
- **實用**
- **作業量**
- **出席**

> 量表（已確認）：**1–5**，並允許「**不適用**」；各維度的文字提示可後補。

### 5.2 文字欄位（範例）
- **優點**
- **缺點/注意事項**
- **修課建議**（給什麼背景的人、如何準備）
- **評語（自由格式）**

## 6. 內容治理（Trust & Safety）

### 6.1 匿名與隱私（已確認）
- **評價一律匿名**
- **可顯示系所**
- **是否允許提及助教/同學/個資**：規則與自動偵測（可後做）

### 6.2 防洗評價（已確認）
- 同一帳號對同一課程：**只能 1 則**
- 新帳號限制：發文需滿足條件（例如驗證完成/滿 X 天）
- 速率限制：短時間大量發文/檢舉

## 7. 資料模型（草案）

### 7.1 實體（Entities）
- **User**：id、角色、驗證狀態、封鎖狀態
- **Course**：課程代碼、課名、系所、學期、老師、學分、時間地點（視資料來源）
- **Instructor**：姓名（同名處理策略待定）
- **Review**：course_id、user_id、學期、各維度分數、文字內容、狀態（正常/隱藏/下架）
- **Report**：review_id、檢舉人、原因、處理狀態、處理紀錄
- **Comment**：留言（**掛在 review**）
- **HelpfulVote**：評價（review）的「有幫助」投票（或用 reaction/like）

### 7.2 課程資料來源（待確認）
- **來源頁面**：`https://webap.nkust.edu.tw/nkust/ag_pro/ag202.jsp`
- **抓取方式（草案）**：
  - 以 **HTTP POST** 直接查詢 `ag202.jsp`（不依賴前端 JS / 不跑瀏覽器）
  - 先送 `reading=""` 取得「系所（unt_id）」下拉選項，再送 `reading=reading` 取得課程結果表格
- **自動更新（草案）**：
  - 透過 GitHub Actions：`.github/workflows/scrape-nkust-ag202.yml`
  - 產出資料：`data/nkust/ag202/{year}/{term}/{cmp_area_id}/{dgr_id}/`（每個 `unt_id` 一個 JSON + `index.json`）
  - 更新頻率：每日排程 + 手動觸發（workflow_dispatch）
  - **範圍（已確認）**：全校區 + 多個學制（目標：全量課程資訊），抓到的課程 JSON 會 commit 到 repo

## 8. 非功能需求（NFR）
- **效能**：課程頁/搜尋回應時間目標（待定）
- **安全**：防 XSS/CSRF、密碼雜湊、權限控管、審計紀錄
- **可用性**：手機優先、無障礙（可後做）
- **備份與復原**：資料庫備份策略（待定）

## 9. 法規/校內規範（必須先釐清）
- 是否涉及個資法、校內公開規範、誹謗/名譽權風險處理機制
- 下架流程與申訴窗口（若需要）

## 10. 待確認問題（請你逐題回答或挑重要的先回）

（已全部回覆 ✅，保留後續待釐清小題）

（已全部釐清 ✅）

## 11. 變更紀錄
- 2025-12-14：建立初稿
- 2025-12-14：確認使用者/驗證/可見性/評分維度/治理與互動需求


