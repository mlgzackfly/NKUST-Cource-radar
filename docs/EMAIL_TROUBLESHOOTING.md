# ç™»å…¥é€£çµæ”¶ä¸åˆ°å•é¡Œè¨ºæ–·

## å¿«é€Ÿæª¢æŸ¥æ¸…å–®

### 1ï¸âƒ£ Zeabur ç’°å¢ƒè®Šæ•¸è¨­å®š âš ï¸ **æœ€å¸¸è¦‹å•é¡Œ**

**æª¢æŸ¥æ­¥é©Ÿï¼š**
1. æ‰“é–‹ Zeabur æ§åˆ¶å°
2. é€²å…¥æ‚¨çš„æœå‹™
3. é»æ“Š **Variables** æ¨™ç±¤
4. ç¢ºèªä»¥ä¸‹ç’°å¢ƒè®Šæ•¸**å…¨éƒ¨éƒ½æœ‰è¨­å®š**ï¼š

```bash
RESEND_API_KEY=re_xxxxxxxxxx
EMAIL_FROM=noreply@your-domain.com
NEXTAUTH_URL=https://your-app.zeabur.app
NEXTAUTH_SECRET=xxxxxxxxxxxxxxxx
DATABASE_URL=postgresql://...
```

**âŒ å¸¸è¦‹éŒ¯èª¤ï¼š**
- `.env.local` æ–‡ä»¶åªåœ¨æœ¬åœ°æœ‰æ•ˆï¼Œä¸æœƒè‡ªå‹•åŒæ­¥åˆ° Zeabur
- å¿…é ˆåœ¨ Zeabur æ§åˆ¶å°æ‰‹å‹•æ·»åŠ ç’°å¢ƒè®Šæ•¸
- ä¿®æ”¹ç’°å¢ƒè®Šæ•¸å¾Œéœ€è¦**é‡æ–°éƒ¨ç½²**

---

### 2ï¸âƒ£ Resend Domain é©—è­‰

æ‚¨éœ€è¦åœ¨ Resend é©—è­‰æ‚¨è‡ªå·±çš„ domainã€‚

**æª¢æŸ¥æ­¥é©Ÿï¼š**
1. ç™»å…¥ [Resend Dashboard](https://resend.com/domains)
2. æª¢æŸ¥æ‚¨çš„ domain ç‹€æ…‹æ˜¯å¦ç‚º **Verified** âœ“

**å¦‚æœæœªé©—è­‰ï¼š**
- æ·»åŠ  Resend æä¾›çš„ DNS è¨˜éŒ„åˆ°æ‚¨çš„åŸŸåæœå‹™å•†
- ç­‰å¾… DNS å‚³æ’­ï¼ˆå¯èƒ½éœ€è¦å¹¾åˆ†é˜åˆ°å¹¾å°æ™‚ï¼‰

**æ›¿ä»£æ–¹æ¡ˆï¼ˆå¿«é€Ÿæ¸¬è©¦ï¼‰ï¼š**
ä½¿ç”¨ Resend æä¾›çš„æ¸¬è©¦ domainï¼š
```
EMAIL_FROM=onboarding@resend.dev
```
âš ï¸ é€™å€‹åªèƒ½ç”¨æ–¼æ¸¬è©¦ï¼Œä¸èƒ½ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ

---

### 3ï¸âƒ£ æª¢æŸ¥ Zeabur æ‡‰ç”¨æ—¥èªŒ

**æ­¥é©Ÿï¼š**
1. Zeabur æ§åˆ¶å° â†’ æ‚¨çš„æœå‹™ â†’ **Logs** æ¨™ç±¤
2. å˜—è©¦ç™»å…¥
3. æŸ¥æ‰¾ä»¥ä¸‹æ—¥èªŒï¼š

**æ­£å¸¸æ—¥èªŒï¼š**
```
=== sendVerificationRequest called ===
Email (original): c109193108@nkust.edu.tw
Email (normalized): C109193108@nkust.edu.tw
âœ“ Email validation passed
Sending email via Resend...
âœ“ Email sent successfully!
```

**éŒ¯èª¤æ—¥èªŒç¯„ä¾‹ï¼š**
```
âŒ Failed to send email: Missing API key
âŒ Failed to send email: Domain not verified
âŒ Failed to send email: Invalid recipient
```

---

### 4ï¸âƒ£ Resend API Key æ¬Šé™

**æª¢æŸ¥æ­¥é©Ÿï¼š**
1. ç™»å…¥ [Resend Dashboard](https://resend.com/api-keys)
2. ç¢ºèªæ‚¨çš„ API Keyï¼š
   - ç‹€æ…‹ï¼š**Active**
   - æ¬Šé™ï¼š**Sending access**
3. å¦‚æœä¸ç¢ºå®šï¼Œé‡æ–°ç”Ÿæˆä¸€å€‹æ–°çš„ API Key

---

### 5ï¸âƒ£ éƒµä»¶è¢«éæ¿¾

**å¦‚æœä»¥ä¸Šéƒ½æ­£å¸¸ï¼Œä½†é‚„æ˜¯æ”¶ä¸åˆ°ï¼š**

1. **æª¢æŸ¥åƒåœ¾éƒµä»¶è³‡æ–™å¤¾**
   - é«˜ç§‘å¤§ä¿¡ç®±å¯èƒ½æœƒå°‡å¤–éƒ¨éƒµä»¶æ¨™è¨˜ç‚ºåƒåœ¾éƒµä»¶

2. **æª¢æŸ¥éƒµä»¶ä¼ºæœå™¨è¦å‰‡**
   - æŸäº›å­¸æ ¡éƒµä»¶ç³»çµ±æœƒå°é–å¤–éƒ¨è‡ªå‹•åŒ–éƒµä»¶
   - å˜—è©¦ç”¨å…¶ä»– @nkust.edu.tw ä¿¡ç®±æ¸¬è©¦

3. **æŸ¥çœ‹ Resend Logs**
   - [Resend Dashboard](https://resend.com/emails) â†’ Emails
   - æŸ¥çœ‹éƒµä»¶æ˜¯å¦æˆåŠŸç™¼é€ï¼ˆç‹€æ…‹æ‡‰ç‚º "Delivered"ï¼‰
   - å¦‚æœé¡¯ç¤º "Bounced" æˆ– "Rejected"ï¼Œé»æ“ŠæŸ¥çœ‹åŸå› 

---

## ğŸ”§ å¿«é€Ÿä¿®å¾©æ­¥é©Ÿ

### Step 1: è¨­å®š Zeabur ç’°å¢ƒè®Šæ•¸

```bash
# åœ¨ Zeabur Variables ä¸­æ·»åŠ ï¼ˆè«‹æ›¿æ›ç‚ºæ‚¨è‡ªå·±çš„å€¼ï¼‰ï¼š
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxx  # å¾ Resend Dashboard å–å¾—
EMAIL_FROM=noreply@your-domain.com            # æ‚¨é©—è­‰éçš„ domain
NEXTAUTH_URL=https://your-app.zeabur.app      # æ‚¨çš„å¯¦éš›ç¶²å€
NEXTAUTH_SECRET=xxxxxxxxxxxxxxxxxxxxxxxx      # åŸ·è¡Œ openssl rand -base64 32 ç”¢ç”Ÿ
```

### Step 2: é‡æ–°éƒ¨ç½²

åœ¨ Zeabur æ§åˆ¶å°é»æ“Š **Redeploy** æˆ–æ¨é€æ–° commit è§¸ç™¼éƒ¨ç½²

### Step 3: æ¸¬è©¦

1. è¨ªå• `https://your-app.zeabur.app/auth/signin`
2. è¼¸å…¥æ‚¨çš„ @nkust.edu.tw ä¿¡ç®±
3. é»æ“Šã€Œå‚³é€ç™»å…¥é€£çµã€
4. æŸ¥çœ‹ Zeabur Logs

---

## ğŸ§ª æ¸¬è©¦éƒµä»¶ç™¼é€ï¼ˆå¯é¸ï¼‰

å»ºç«‹æ¸¬è©¦è…³æœ¬é©—è­‰ Resend é…ç½®ï¼š

```bash
# åœ¨æœ¬åœ°é‹è¡Œ
node scripts/test-email.mjs
```

å¦‚æœæ¸¬è©¦æˆåŠŸä½†ç¶²ç«™é‚„æ˜¯æ”¶ä¸åˆ°ï¼Œå•é¡Œåœ¨æ–¼ Zeabur ç’°å¢ƒè®Šæ•¸æœªè¨­å®šã€‚

---

## å¸¸è¦‹å•é¡Œ Q&A

### Q1: ç‚ºä»€éº¼æœ¬åœ°å¯ä»¥æ”¶åˆ°ï¼ŒZeabur æ”¶ä¸åˆ°ï¼Ÿ
**A**: `.env.local` åªåœ¨æœ¬åœ°æœ‰æ•ˆã€‚å¿…é ˆåœ¨ Zeabur æ§åˆ¶å°è¨­å®šç’°å¢ƒè®Šæ•¸ã€‚

### Q2: æˆ‘è¨­å®šäº†ç’°å¢ƒè®Šæ•¸ï¼Œç‚ºä»€éº¼é‚„æ˜¯ä¸è¡Œï¼Ÿ
**A**: ä¿®æ”¹ç’°å¢ƒè®Šæ•¸å¾Œå¿…é ˆ**é‡æ–°éƒ¨ç½²**æ‡‰ç”¨ã€‚

### Q3: å¯ä»¥ç”¨ Gmail ç™¼é€å—ï¼Ÿ
**A**: ä¸å»ºè­°ã€‚Resend æ˜¯å°ˆç‚ºæ‡‰ç”¨éƒµä»¶è¨­è¨ˆçš„æœå‹™ï¼ŒGmail SMTP å¯èƒ½è¢«å°é–æˆ–é™æµã€‚

### Q4: EMAIL_FROM çš„ domain å¦‚ä½•è¨­å®šï¼Ÿ
**A**: é€™æ˜¯æ‚¨åœ¨ Resend è¨­å®šä¸¦é©—è­‰çš„ç™¼ä»¶ domainã€‚å¿…é ˆåœ¨ Resend ä¸­é©—è­‰æ‰èƒ½ä½¿ç”¨ã€‚

### Q5: æˆ‘å¯ä»¥æ”¹æˆå…¶ä»–éƒµä»¶æœå‹™å—ï¼Ÿ
**A**: å¯ä»¥ï¼Œä½†éœ€è¦ä¿®æ”¹ NextAuth é…ç½®ã€‚Resend æ˜¯æœ€ç°¡å–®çš„æ–¹æ¡ˆã€‚

---

## ğŸ“ ä»ç„¶ç„¡æ³•è§£æ±ºï¼Ÿ

è«‹æä¾›ä»¥ä¸‹è³‡è¨Šï¼š

1. âœ… Zeabur ç’°å¢ƒè®Šæ•¸æˆªåœ–ï¼ˆ**é®è”½æ•æ„Ÿè³‡è¨Š**ï¼‰
2. âœ… Zeabur Logs ä¸­èˆ‡ç™»å…¥ç›¸é—œçš„æ—¥èªŒ
3. âœ… Resend Dashboard ä¸­éƒµä»¶ç™¼é€ç‹€æ…‹
4. âœ… ä½¿ç”¨çš„ä¿¡ç®±ï¼ˆå®Œæ•´ emailï¼‰
5. âœ… æ˜¯å¦æª¢æŸ¥éåƒåœ¾éƒµä»¶è³‡æ–™å¤¾

---

**æœ€å¾Œæ›´æ–°ï¼š** 2024-12-19
